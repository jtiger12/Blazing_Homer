@using Microsoft.AspNetCore.Components.Web

<div class="search-container">
    <div class="search-input-wrapper">
        <i class="fas fa-search search-icon"></i>
        <input type="text" 
               class="search-input" 
               placeholder="Search services..." 
               @bind="SearchTerm" 
               @bind:event="oninput"
               @onkeydown="OnKeyDown" />
        @if (!string.IsNullOrEmpty(SearchTerm))
        {
            <button class="search-clear" @onclick="ClearSearch" title="Clear search">
                <i class="fas fa-times"></i>
            </button>
        }
    </div>
</div>

@code {
    [Parameter] public string SearchTerm { get; set; } = string.Empty;
    [Parameter] public EventCallback<string> SearchTermChanged { get; set; }

    private async Task OnKeyDown(KeyboardEventArgs e)
    {
        if (e.Key == "Escape")
        {
            await ClearSearch();
        }
    }

    private async Task ClearSearch()
    {
        SearchTerm = string.Empty;
        await SearchTermChanged.InvokeAsync(SearchTerm);
    }
}
